<%- include('header') %>

<div class="container list-property-container">
  <div class="list-property-card">
    <h2>List a Property</h2>
    
    <% if (error) { %>
      <div class="form-error"><%= error %></div>
    <% } %>
    
    <form action="/list" method="post" enctype="multipart/form-data">
      
      <div class="form-group form-group-full">
        <label for="title">Property Title *</label>
        <input type="text" id="title" name="title" required placeholder="e.g., Spacious 2BHK Near College" />
      </div>

      <div class="form-group form-group-full">
        <label for="description">Description *</label>
        <textarea id="description" name="description" required placeholder="Describe your property in detail..."></textarea>
      </div>

      
      <div class="form-row">
        <div class="form-group">
          <label for="propertyType">Property Type</label>
          <select id="propertyType" name="propertyType">
            <option value="pg">PG (Paying Guest)</option>
            <option value="hostel">Hostel</option>
            <option value="flat">Flat</option>
          </select>
        </div>
        <div class="form-group">
          <label for="city">City *</label>
          <select id="city" name="city" required>
            <option value="">Select a City</option>
            <% if (cities && cities.length) { %>
              <% cities.forEach(function(city) { %>
                <option value="<%= city.name %>"><%= city.name %></option>
              <% }) %>
            <% } %>
          </select>
        </div>
      </div>

      
      <div class="form-row">
        <div class="form-group">
          <label for="area">Area / Locality</label>
          <input type="text" id="area" name="area" placeholder="e.g., Koramangala, Bangalore" />
        </div>
        <div class="form-group">
          <label for="price">Price (monthly) *</label>
          <input type="number" id="price" name="price" required min="0" placeholder="â‚¹ per month" />
        </div>
      </div>

      
      <div class="form-row">
        <div class="form-group">
          <label for="roomType">Room Type</label>
          <select id="roomType" name="roomType">
            <option value="single">Single</option>
            <option value="double">Double</option>
            <option value="triple">Triple</option>
            <option value="shared">Shared</option>
          </select>
        </div>
        <div class="form-group">
          <label for="genderPreference">Gender Preference</label>
          <select id="genderPreference" name="genderPreference">
            <option value="any">Any</option>
            <option value="male">Male</option>
            <option value="female">Female</option>
          </select>
        </div>
      </div>


      <div class="form-row">
        <div class="form-group">
          <label for="availableRooms">Available Rooms</label>
          <input type="number" id="availableRooms" name="availableRooms" min="0" placeholder="Number of rooms available" />
        </div>
        <div class="form-group">
          <label for="distanceFromCollege">Distance From College (km)</label>
          <input type="number" id="distanceFromCollege" step="any" name="distanceFromCollege" min="0" placeholder="Distance in kilometers" />
        </div>
      </div>

 
      <div class="form-group form-group-full">
        <label for="amenities">Amenities (comma separated)</label>
        <input type="text" id="amenities" name="amenities" placeholder="WiFi, Meals, Laundry, AC, Parking, etc." />
        <p class="form-hint">Separate each amenity with a comma for better filtering</p>
      </div>

     
      <div class="form-group form-group-full">
        <label for="images">Upload Images (max 6)</label>
        <input type="file" id="images" name="images" multiple accept="image/*" />
        <p class="form-hint">Add up to 6 high-quality photos (max 5MB each). Photos help renters decide faster!</p>
        <div id="imagePreview" class="image-preview" style="margin-top: 0.75rem; display:flex; gap:0.5rem; flex-wrap:wrap;"></div>
      </div>

     
      <div class="form-actions">
        <button type="submit" class="btn-primary">List Property</button>
        <a href="/profile">Cancel</a>
      </div>
    </form>
  </div>
</div>

<%- include('footer') %>
<script>
  const imagesInput = document.getElementById('images');
  const imagePreview = document.getElementById('imagePreview');
  if (imagesInput && imagePreview) {
    imagesInput.addEventListener('change', function () {
      imagePreview.innerHTML = '';
      const files = Array.from(this.files || []).slice(0,6);
      for (const f of files) {
        if (!f.type.startsWith('image/')) continue;
        const reader = new FileReader();
        reader.onload = (e) => {
          const img = document.createElement('img');
          img.src = e.target.result;
          img.alt = 'Preview';
          img.style.width = '96px';
          img.style.height = '64px';
          img.style.objectFit = 'cover';
          img.style.borderRadius = '6px';
          img.style.border = '1px solid #e8ebf0';
          imagePreview.appendChild(img);
        };
        reader.readAsDataURL(f);
      }
    });
  }
</script>

