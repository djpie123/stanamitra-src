<!DOCTYPE html>
<html lang="en">
  <%- include('header'); -%>

  <body>
    <%- include('nav'); -%>

    <section class="hero contact-hero">
      <div class="hero-overlay"></div>
      <div class="container">
        <div class="hero-content">
          <h2>Create account</h2>
          <p>Sign up to save your favorite properties and list your own.</p>
        </div>
      </div>
    </section>

    <section class="section-about">
      <div class="container">
        <div class="auth-card">
          <div class="auth-header">
            <h2>Create your account</h2>
            <p>Sign up to save favorites, list properties, and manage bookings.</p>
          </div>
          <% if (successMessage) { %>
            <div class="alert-success"><%= successMessage %></div>
          <% } %>
          <% if (typeof error !== 'undefined' && error) { %>
            <div class="alert-error"><%= error %></div>
          <% } %>
          <form action="/register" method="post" class="register-form">
            <div class="form-group">
              <label class="input-label" for="name">Full name</label>
              <input class="input-field" type="text" placeholder="Full name" name="name" id="name" required aria-required="true" />
            </div>
            <div class="form-group">
              <label class="input-label" for="email">Email</label>
              <input class="input-field" type="email" placeholder="you@example.com" name="email" id="email" required aria-required="true" />
            </div>
            <div class="form-group" style="position:relative;">
              <label class="input-label" for="password">Password</label>
              <input class="input-field" type="password" placeholder="Create a strong password" name="password" id="password" required minlength="6" aria-required="true" />
              <span class="password-toggle" id="toggleRegPassword" style="position:absolute; right:12px; top:36px;">Show</span>
              <div class="helper-text">Must be at least 6 characters.</div>
            </div>
            <div class="form-group" style="position:relative;">
              <label class="input-label" for="confirmPassword">Confirm password</label>
              <input class="input-field" type="password" placeholder="Confirm password" name="confirmPassword" id="confirmPassword" required minlength="6" aria-required="true" />
              <span class="password-toggle" id="toggleRegConfirm" style="position:absolute; right:12px; top:36px;">Show</span>
              <div class="input-error" id="pw-error" style="display:none;">Passwords do not match</div>
            </div>
            <div style="margin-top:1rem;">
              <button class="btn-primary btn-full" type="submit">Create Account</button>
            </div>
          </form>

          <div class="auth-links">Already have an account? <a href="/login">Login</a></div>
        </div>
      </div>
    </section>

    <%- include('footer'); -%>

    <script>
      
      document.addEventListener('DOMContentLoaded', function () {
        const form = document.querySelector('.register-form');
        const pwInput = document.getElementById('password');
        const confirmInput = document.getElementById('confirmPassword');
        const pwError = document.getElementById('pw-error');
        const togglePw = document.getElementById('toggleRegPassword');
        const toggleConfirm = document.getElementById('toggleRegConfirm');
        if (!form) return;
        function toggleVisibility(input, toggle) {
          if (!input || !toggle) return;
          toggle.addEventListener('click', function() {
            if (input.type === 'password') { input.type = 'text'; toggle.textContent = 'Hide'; } else { input.type = 'password'; toggle.textContent = 'Show'; }
          });
        }
        toggleVisibility(pwInput, togglePw);
        toggleVisibility(confirmInput, toggleConfirm);
        form.addEventListener('submit', function (e) {
          if (pwInput.value !== confirmInput.value) {
            e.preventDefault();
            if (pwError) { pwError.style.display = 'block'; }
            confirmInput.focus();
            return false;
          }
          if (pwError) { pwError.style.display = 'none'; }
        });
      });
    </script>
  </body>
</html>